<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Produto</title>
    <link rel="stylesheet" href="style.css"> 
</head>
<body>
    
    <header>
        <nav class="navbar">
            <ul>
                <li><a href="index.html" class="active">Cadastrar Produto</a></li>
                <li><a href="procurarProduto.html">Procurar Produto</a></li>
                <li><a href="apagarProduto.html" >Apagar Produto</a></li>
                <li><a href="atualizarProduto.html" >Atualizar Produto</a></li>
                <li><a href="procurar.html">Busca Filtro</a></li>
                <li><a href="procuraValor.html" >Produto Menor</a></li>
                
            </ul>
        </nav>
    </header>

    
    <div class="container" id="cadastroProduto">
        <h2>Cadastro de Produto</h2>
        <form id="formProduto" method="POST">
            <div class="input-box">
                <input type="text" id="descricao" placeholder="Descrição do Produto" name="prod_desc" required />
            </div>

            <div class="input-box">
                <input type="date" id="dtvalidade" placeholder="Data de Validade" name="prod_dtvalid" required />
            </div>

            <div class="input-box">
                <input type="number" id="valor" placeholder="Valor Unitário (R$)" name="prod_valorun" required />
            </div>

            <div class="input-box">
                <input type="text" id="categoria" placeholder="* Codigo da categoria" name="cat_cod" required />
            </div>
        </form>
        <button onclick="cadastrarProduto()">Cadastrar</button>
        <p id="mensagem"></p>
    </div>

<script>
function listarProdutos() {
    fetch("http://localhost:8080/api/produtos")
        .then(response => response.json())
        .then(produtos => {
            console.log(produtos);
        })
        .catch(error => console.error("Erro ao listar produtos:", error));
}

function cadastrarProduto() {
  

    let formData = new FormData();
    let desc = document.getElementById("descricao").value;
    let validade = document.getElementById("dtvalidade").value;
    let valor = document.getElementById("valor").value;

    let categoria = document.getElementById("categoria").value;
    console.log("Dados a enviar:", { desc, validade, valor, categoria });

    formData.append("prod_dtvalid", validade);
    formData.append("prod_desc", desc);
    
    formData.append("prod_valorun", valor);
    formData.append("categoria", categoria);

    fetch("http://localhost:8080/apis/produto", {
        method: "POST",
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            return response.text().then(text => {
                console.error("Erro detalhado da API:", text);
                throw new Error("Erro ao cadastrar");
            });
        }
        return response.json();
    })
    .then(json => {
        document.getElementById("mensagem").textContent = "Produto cadastrado com sucesso!";
        document.getElementById("formProduto").reset();
        console.log(json);
    })
    .catch(error => {
        console.error("Erro ao cadastrar produto:", error);
        document.getElementById("mensagem").textContent = "Erro ao cadastrar produto.";
    });
}
</script>

    
</body>
</html>
